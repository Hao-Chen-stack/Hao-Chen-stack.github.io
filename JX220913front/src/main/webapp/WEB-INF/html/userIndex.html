<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <title>用户首页</title>
    <script src="js/jquery-1.12.4.min.js"></script>
    <script src="js/layui-v2.6.8/layui/layui.js"></script>
    <link rel="stylesheet" href="js/layui-v2.6.8/layui/css/layui.css">
    <script th:src="@{/js/jquery-1.12.4.min.js}"></script>
<!--    <style>-->
<!--        html{-->
<!--            background: url("img/userback.jpg");-->
<!--        }-->
<!--    </style>-->
</head>
<body>
<div id="top">
    <ul class="layui-nav" lay-filter="" style="text-align: center;">
        <li class="layui-nav-item"><a href="appointmentList" target="con">我要预约</a></li>
        <li class="layui-nav-item"><a href="MyReport" target="con">我的报告</a></li>
        <li class="layui-nav-item"><a href="onlineAss" target="con">在线评估</a></li>
<!--        <li class="layui-nav-item">-->
<!--            <a href="javascript:;">我的预约</a>-->
<!--            <dl class="layui-nav-child"> &lt;!&ndash; 二级菜单 &ndash;&gt;-->
<!--                <dd><a href="">预约详情</a></dd>-->
<!--                <dd><a href="">以往账单</a></dd>-->
<!--                <dd><a href="">咨询师评价</a></dd>-->
<!--            </dl>-->
<!--        </li>-->
        <li class="layui-nav-item"><a href="billByUserAcc" target="con">我的账户</a></li>
        <li class="layui-nav-item">
            <a href=""><img th:src="@{/img/1.png}" class="layui-nav-img" alt="1">个人信息</a>
            <dl class="layui-nav-child">
                <dd><a href="javascript:;">修改信息</a></dd>
                <dd><a href="javascript:;">安全管理</a></dd>
                <dd><a href="logout">退了</a></dd>
            </dl>
        </li>
    </ul>
</div>
<div id="context" style="padding: 15px;width: 100%;height: 600px;">
    <!-- 内容主体区域 -->
    <iframe width="100%" height="130%" src="" frameborder="0" name="con"></iframe>
</div>
</body>
<script>
    //注意：导航 依赖 element 模块，否则无法进行功能性操作
    layui.use('element', function(){
        var element = layui.element;

        //…
    });
</script>
<script>

    $(function () {
        stopAppointCount();
    })

    //查询被停止预约的列表的总条数
    function stopAppointCount() {
        $.ajax({
            url:"appointment/stopAppointCount",
            dataType:"json",
            success:function (i) {
                if (i>0){
                    //如果条数大于0则登录成功后弹出被管理员停止预约的用户列表的弹窗
                    layer.open({
                        title: '新的被终止信息'
                        ,content: '是否前往查看'
                        // ,type:2 ---content可以填url进行内嵌
                        ,btn: ['是', '不再提醒']
                        ,yes: function(){
                            $(location).attr('href', 'StopAppointWin');
                        }
                        ,btn2: function(){
                            //否按钮关闭回调
                            //return false 开启该代码可禁止点击该按钮关闭
                            updateManagerStopAns();
                        }
                        ,cancel: function(){
                            //右上角关闭回调
                            //return false 开启该代码可禁止点击该按钮关闭
                        }
                    });
                }
            }
        })

    }

    //咨询师点击不再提醒后修改弹窗的状态
    function updateManagerStopAns() {
        $.ajax({
            url: "appointment/updateUserStopAns",
            dataType: "json",
            success:function (i) {
                if (i>0){
                    alert("已设置为不再提醒")
                }else {
                    alert("设置为不再提醒失败")
                }
            }
        })
    }

</script>
</html>